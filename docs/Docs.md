# Documentation

The documentation in the `docs/out`-Directory is generated by the DocGenerator-Script. The DocGenerator can be executed with this composer command:

```
composer run-script docs-generator
```

If you change something in the Docs (`docs/src/ressources`) make sure you execute the DocGenerator and commit also the generated output files!

The Generator will take the template-docs (`docs/src/ressources`) and transform the code samples to real code for the documentation. There are two types of code samples:
1. Templates to include Unit-Test (see [Template-Snippets](#template-snippets))
2. Code examples that are executed (see [PHP-Snippets](#php-snippets-deprecated))

## Template-Snippets

With the template-snippets code from unit-tests can be included. The main adventage is, that this code also extends and improves the unit-test suite. The Github CI executes this unit-tests and ensure that they are working code. To include a unit-test code-sample you cann use this template syntax:

```
{{ \Tests\Unit\Docs\EventRequestTest.testEventRequestDocExample }}
```

The Doc-Generator takes the unit-test code an transform the `assertEquals`-Statements to a more readable code. All Unit-Test for the documentation are stored in the directory `tests/unit/docs/`. For example the already mentioned unit-test `testEventRequestDocExample` has this assert-statement:

```php
$this->assertEquals(21, $christmasService->getId());
```

This is transformed by the doc-generator to a more readable code:

```php
var_dump( $christmasService->getId());
// Output: 21
```

- ⚠ Just use `assertEquals`-Statements. Other Assertions wont be transformed.
- ⚠ Don't use Assert-Statements in a loop or if-/switch-statement.
- ⚠ Only use simple values as assert-paremter (string, int, boolean) and not objects or arrays.

## PHP-Snippets (Deprecated)

⚠ Don't use this approach for new documentation. The drawback of this technique is that all code-samples are not extending the unit-test suite and therefore are not tested by the Unit-Test CI-Pipeline.

PHP-Snippets are used by `docs/src/ressources/CTConfig.md`. The idea is quite simple. All code examples are executed by the doc-generator. With the `dd`-function the content of variables can be displayed to the user.

This example Code-Snippet...

```php 
$a = 2 + 2;
dd($a);
```

...will be transfered to this Doc:

```php
$a = 2 + 2;
echo ($a);
// OUTPUT: 4
```

The Generator converts the "dd"-Function call to an "echo" call. In the next Line it will display the content of the variable $a.

- ⚠ The `dd(...)`-Method is not allowed in any kind of Loop or If/Switch-Statement.

## Execution Enviroment
The Generator-Script builds the CTClientMock-Enviroment. All Http calls are redirected to the Json-Files in the `tests/unit/HttpMock/data`-directory.

## Github-Action

The doc-generator GithubAction executes the DocGenerator. Then it checks if there are any uncommited changes. If so it fails. To fix this execute the doc-generator locally an commit all generated doc files.